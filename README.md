# FLTG ë¹„ì”í‹´ ê°•ê±´ ì—°í•© í•™ìŠµ êµ¬í˜„ ë° ê²€ì¦
## í…€ í”„ë¡œì íŠ¸ ì œì¶œë¬¼

---

# FLTG ë¹„ì”í‹´ ê°•ê±´ ì—°í•© í•™ìŠµ êµ¬í˜„ ë° ê²€ì¦

## ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”

ë³¸ í”„ë¡œì íŠ¸ëŠ” ë…¼ë¬¸ "FLTG: Byzantine-Robust Federated Learning via Angle-Based Defense and Non-IID-Aware Weighting"ì—ì„œ ì œì•ˆëœ ë¹„ì”í‹´ ê³µê²© ë°©ì–´ ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•˜ê³ , ë‹¤ì–‘í•œ ì‹¤í—˜ í™˜ê²½ì—ì„œ ì„±ëŠ¥ì„ ê²€ì¦í•œ ì—°êµ¬ì…ë‹ˆë‹¤.

### ì£¼ìš” ëª©í‘œ
- FLTG ì•Œê³ ë¦¬ì¦˜ì˜ ì™„ì „í•œ êµ¬í˜„
- ê¸°ì¡´ ë°©ì–´ ê¸°ë²•(FedAVG, Krum, Trimmed-Mean)ê³¼ì˜ ì„±ëŠ¥ ë¹„êµ
- ë‹¤ì–‘í•œ Non-IID í™˜ê²½ ë° ë¹„ì”í‹´ ê³µê²© ì‹œë‚˜ë¦¬ì˜¤ì—ì„œì˜ ê²€ì¦
- ë…¼ë¬¸ì˜ í•µì‹¬ ì£¼ì¥ì— ëŒ€í•œ ì‹¤ì¦ì  ê²€ì¦

### ê¸°ë°˜ í”„ë ˆì„ì›Œí¬
- [CRYPTO-KU/FL-Byzantine-Library](https://github.com/CRYPTO-KU/FL-Byzantine-Library)
- PyTorch ê¸°ë°˜ ì—°í•© í•™ìŠµ ë° ë¹„ì”í‹´ ê³µê²©/ë°©ì–´ ë¼ì´ë¸ŒëŸ¬ë¦¬

---

## ğŸ”¬ êµ¬í˜„ ë‚´ìš©

### 1. FLTG ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„

FLTGëŠ” 5ë‹¨ê³„ì˜ ì •êµí•œ ë°©ì–´ ë©”ì»¤ë‹ˆì¦˜ìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤:

#### Step 1: ReLU-Clipped Cosine Similarity Filtering
```python
# ì„œë²„ì˜ ë£¨íŠ¸ ë°ì´í„°ì…‹ìœ¼ë¡œ ê³„ì‚°í•œ ê·¸ë˜ë””ì–¸íŠ¸ì™€ í´ë¼ì´ì–¸íŠ¸ ì—…ë°ì´íŠ¸ ê°„ì˜ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ê³„ì‚°
cos_sims_with_server = [F.cosine_similarity(g, g0, dim=0) for g in inputs]
# ìŒìˆ˜ ìœ ì‚¬ë„(ë°˜ëŒ€ ë°©í–¥) í•„í„°ë§
filtered_indices = [i for i, sim in enumerate(cos_sims_with_server) if sim > 0]
```
**ëª©ì **: ì„œë²„ì™€ ì •ë°˜ëŒ€ ë°©í–¥ì„ ê°€ë¦¬í‚¤ëŠ” ì•…ì˜ì  ì—…ë°ì´íŠ¸ ì œê±°

#### Step 2: Dynamic Reference Selection
```python
# ì´ì „ ê¸€ë¡œë²Œ ê·¸ë˜ë””ì–¸íŠ¸ì™€ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ê°€ ê°€ì¥ ë‚®ì€ í´ë¼ì´ì–¸íŠ¸ë¥¼ ì°¸ì¡°ì ìœ¼ë¡œ ì„ íƒ
cos_sims_with_prev = [F.cosine_similarity(g, g_prev, dim=0) for g in filtered_inputs]
ref_idx = cos_sims_with_prev.index(min(cos_sims_with_prev))
g_ref = filtered_inputs[ref_idx]
```
**ëª©ì **: Non-IID í™˜ê²½ì—ì„œ "ì •ìƒì´ì§€ë§Œ ê°€ì¥ ë…íŠ¹í•œ" ì—…ë°ì´íŠ¸ë¥¼ ê¸°ì¤€ì ìœ¼ë¡œ í™œìš©

#### Step 3: Non-IID Aware Weighting
```python
# ì°¸ì¡° í´ë¼ì´ì–¸íŠ¸ì™€ì˜ ê°ë„ í¸ì°¨ì— ë°˜ë¹„ë¡€í•˜ì—¬ ê°€ì¤‘ì¹˜ ë¶€ì—¬
scores = []
for g in filtered_inputs:
    cos_sim_with_ref = F.cosine_similarity(g, g_ref, dim=0)
    score = 1.0 - cos_sim_with_ref
    scores.append(F.relu(score))
```
**ëª©ì **: ì°¸ì¡°ì ê³¼ ë‹¤ë¥¼ìˆ˜ë¡ ë†’ì€ ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•˜ì—¬ ë°ì´í„° ë‹¤ì–‘ì„± ë³´ì¥

#### Step 4: Magnitude Normalization
```python
# ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ ì—…ë°ì´íŠ¸ë¥¼ ì„œë²„ ê·¸ë˜ë””ì–¸íŠ¸ì™€ ë™ì¼í•œ í¬ê¸°ë¡œ ì •ê·œí™”
g0_norm = torch.norm(g0)
normalized_g = g * (g0_norm / torch.norm(g))
```
**ëª©ì **: ì•…ì˜ì ì¸ í¬ê¸° ì¡°ì‘(scaling attack) ë°©ì§€

#### Step 5: Weighted Aggregation
```python
# ê°€ì¤‘ì¹˜ë¥¼ ì ìš©í•˜ì—¬ ìµœì¢… ê¸€ë¡œë²Œ ëª¨ë¸ ì—…ë°ì´íŠ¸ ìƒì„±
aggregated = sum(w * g for w, g in zip(weights, normalized_inputs))
```

### 2. í”„ë ˆì„ì›Œí¬ í†µí•©

**ìˆ˜ì •ëœ íŒŒì¼**:
- `FL-Byzantine-Library/Aggregators/fltg.py` - FLTG í´ë˜ìŠ¤ êµ¬í˜„ (ì‹ ê·œ)
- `FL-Byzantine-Library/mapper.py` - FLTGë¥¼ aggregator ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ë“±ë¡
- `FL-Byzantine-Library/parameters.py` - ëˆ„ë½ëœ íŒŒë¼ë¯¸í„° ì¶”ê°€
- `FL-Byzantine-Library/main.py` - í•¨ìˆ˜ í˜¸ì¶œ ì‹œê·¸ë‹ˆì²˜ ìˆ˜ì •

---

## ğŸ§ª ì‹¤í—˜ êµ¬ì„±

### ì‹¤í—˜ 1: ì´ˆê¸° ê²€ì¦ ì‹¤í—˜ (MNIST, IID)

**í™˜ê²½ ì„¤ì •**:
- ë°ì´í„°ì…‹: MNIST
- ëª¨ë¸: MNISTNET (0.431M parameters)
- í´ë¼ì´ì–¸íŠ¸ ìˆ˜: 20ê°œ
- ë¹„ì”í‹´ ë¹„ìœ¨: 20% (4ê°œ)
- ê³µê²© ìœ í˜•: ROP (Relocated Orthogonal Perturbation)
- í•™ìŠµ ë¼ìš´ë“œ: 10 epochs
- ë°ì´í„° ë¶„í¬: IID (ê· ë“± ë¶„í¬)

**ë¹„êµ ëŒ€ìƒ**:
1. Baseline - ê³µê²© ì—†ëŠ” ì´ìƒì  í™˜ê²½
2. FedAVG - ë°©ì–´ ë©”ì»¤ë‹ˆì¦˜ ì—†ìŒ
3. Krum - ìœ í´ë¦¬ë””ì•ˆ ê±°ë¦¬ ê¸°ë°˜ ë°©ì–´
4. Trimmed-Mean - ì¤‘ì•™ê°’ ê¸°ë°˜ ë°©ì–´
5. FLTG - ì œì•ˆëœ ê°ë„ ê¸°ë°˜ ë°©ì–´

**ê²°ê³¼**:
| ë°©ì–´ ê¸°ë²• | Epoch 1 | Epoch 5 | Epoch 10 | Baseline ëŒ€ë¹„ |
|-----------|---------|---------|----------|---------------|
| Baseline | 90.9% | 97.4% | 98.5% | - |
| FedAVG | 75.7% | 97.5% | 98.4% | -0.1%p |
| Trimmed-Mean | 77.5% | 97.3% | 98.2% | -0.3%p |
| Krum | 89.8% | 97.3% | 98.1% | -0.4%p |
| FLTG | 63.6% | 97.4% | 97.1% | -1.4%p |

**ë¬¸ì œì **: MNISTê°€ ë„ˆë¬´ ì‰¬ì›Œì„œ ëª¨ë“  ë°©ë²•ì´ 98%+ ë‹¬ì„± â†’ ì°¨ì´ê°€ ëª…í™•í•˜ì§€ ì•ŠìŒ

### ì‹¤í—˜ 2: ê·¹ë‹¨ì  Non-IID ì‹¤í—˜

ì´ˆê¸° ì‹¤í—˜ì˜ ë¬¸ì œì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ë°ì´í„°ë¥¼ ê·¹ë‹¨ì ìœ¼ë¡œ ë¶ˆê· ë“±í•˜ê²Œ ë¶„ë°°:

**ì‹¤í—˜ ì‹œë‚˜ë¦¬ì˜¤** (ì´ 8ê°œ):

1. **Ultra Extreme Non-IID** (Dirichlet Î±=0.01)
   - 30% Byzantine (6/20 clients)
   - 50% Byzantine (10/20 clients)

2. **Extreme Non-IID** (Dirichlet Î±=0.1)
   - 30% Byzantine
   - 50% Byzantine

3. **Class Imbalance** (í´ë¼ì´ì–¸íŠ¸ë‹¹ ì •í™•íˆ 2ê°œ í´ë˜ìŠ¤)
   - 30% Byzantine
   - 50% Byzantine

4. **ë‹¤ì–‘í•œ ê³µê²© ìœ í˜•** (Ultra Extreme Non-IID + 50% Byzantine)
   - ROP ê³µê²©
   - IPM ê³µê²©

**ì¢…í•© ê²°ê³¼**:
| ë°©ì–´ ê¸°ë²• | ìŠ¹ë¦¬ íšŸìˆ˜ | ìŠ¹ë¥  |
|-----------|-----------|------|
| FLTG | 4/8 | 50.0% |
| FedAVG | 2/8 | 25.0% |
| Krum | 2/8 | 25.0% |
| Trimmed-Mean | 0/8 | 0.0% |

**í•µì‹¬ ë°œê²¬**: 50% Byzantine ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ FLTGê°€ 5/5 ìŠ¹ë¦¬ (100%)

### ì‹¤í—˜ 3: Figure 3 ì¬í˜„ ì‹¤í—˜ (MNIST)

ë…¼ë¬¸ì˜ Figure 3ë¥¼ ì¬í˜„í•˜ê¸° ìœ„í•œ ì‹¤í—˜:

**ì„¤ì •**:
- ë‹¤ì–‘í•œ Root Dataset Bias ìˆ˜ì¤€: 0.1, 0.5, 0.8
- ë¹„ì”í‹´ ë¹„ìœ¨: 0.2, 0.5, 0.8, 0.95
- ì§‘ê³„ ë°©ë²•: FL-Trust, FLTG
- ê³µê²©: MinMax (adaptive poisoning ê·¼ì‚¬)

**ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸**: `run_fig3_mnist.py`

### ì‹¤í—˜ 4: Figure 4 ì¬í˜„ ì‹¤í—˜ (MNIST)

ë…¼ë¬¸ì˜ Figure 4ë¥¼ ì¬í˜„í•˜ê¸° ìœ„í•œ ì‹¤í—˜:

**ì„¤ì •**:
- Dirichlet Î± ìˆ˜ì¤€: 0.1, 0.5, 1.0 (Non-IID ì •ë„)
- ë¹„ì”í‹´ ë¹„ìœ¨: 0.2, 0.5, 0.8, 0.9, 0.95
- ì§‘ê³„ ë°©ë²•: FL-Trust, FLTG
- ê³µê²©: ROP

**ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸**: `run_fig4_mnist.py`

### ì‹¤í—˜ 5: CIFAR-10 ì‹¤í—˜

ë” ë³µì¡í•œ ë°ì´í„°ì…‹ì—ì„œì˜ ê²€ì¦:

**ì„¤ì •**:
- ë°ì´í„°ì…‹: CIFAR-10
- ëª¨ë¸: ResNet-20
- í´ë¼ì´ì–¸íŠ¸ ìˆ˜: 80ê°œ
- Epochs: 50
- Dirichlet Î±: 0.5
- Root Dataset Bias: 0.1, 0.5, 0.8
- ë¹„ì”í‹´ ë¹„ìœ¨: 0.2, 0.5, 0.8, 0.95

**ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸**: `new_run_fig3_cifar.py`

---

## ğŸ“Š ì£¼ìš” ì‹¤í—˜ ê²°ê³¼

### 1. 50% Byzantine í™˜ê²½ì—ì„œì˜ FLTG ìš°ìœ„

**Ultra Extreme Non-IID (Î±=0.01) + 50% Byzantine**:
```
FLTG:          Epoch 1: 10.7% â†’ Epoch 20: 75.3% (+64.6%p) â­
FedAVG:        Epoch 1: 21.6% â†’ Epoch 20: 66.6% (+45.0%p)
Trimmed-Mean:  Epoch 1:  9.8% â†’ Epoch 20: 10.3% (+0.5%p) âŒ
Krum:          ì‹¤í–‰ ì‹¤íŒ¨ (Byzantine ë¹„ìœ¨ ë„ˆë¬´ ë†’ìŒ)
```

**Class Imbalance + 50% Byzantine** (ê°€ì¥ ê·¹ì ì¸ ê²°ê³¼):
```
FLTG:          31.4% â†’ 96.0% (+64.6%p) â­â­â­
FedAVG:        10.3% â†’ 10.3% (ìˆ˜ë ´ ì‹¤íŒ¨)
Trimmed-Mean:  10.1% â†’  9.8% (ìˆ˜ë ´ ì‹¤íŒ¨)
Krum:          ì‹¤í–‰ ì‹¤íŒ¨
```
â†’ **ë‹¤ë¥¸ ëª¨ë“  ë°©ë²•ì´ ì‹¤íŒ¨í–ˆì„ ë•Œ FLTGë§Œ 96% ë‹¬ì„±!**

**Extreme ROP 50% Byzantine**:
```
FLTG:   95.3% â­
FedAVG: 84.6%
```

**Extreme IPM 50% Byzantine**:
```
FLTG:   96.2% â­
FedAVG: 88.7%
```

### 2. 30% Byzantine í™˜ê²½ì—ì„œì˜ ê²°ê³¼

```
Ultra Extreme 30%: FedAVG 97.5% > FLTG 94.6%
Extreme 30%:       Krum 98.4% > FedAVG 97.3% â‰ˆ FLTG 97.3%
Class Imbal 30%:   Krum 98.5% > FedAVG 97.8% > FLTG 96.5%
```
â†’ ë‚®ì€ Byzantine ë¹„ìœ¨ì—ì„œëŠ” ì „í†µì  ë°©ë²•ì´ ë” íš¨ìœ¨ì 

### 3. í•™ìŠµ íŠ¹ì„± ë¶„ì„

**ì´ˆê¸° í•™ìŠµ ì†ë„** (Epoch 1):
- Krum: 89.8% (ê°€ì¥ ë¹ ë¦„)
- Trimmed-Mean: 77.5%
- FedAVG: 75.7%
- FLTG: 63.6% (ê°€ì¥ ëŠë¦¼) âš ï¸

**FLTGì˜ í•™ìŠµ íŒ¨í„´**:
```
Epoch 1-5:   ë§¤ìš° ëŠë¦° ì‹œì‘ (10-30%) ğŸ”´
Epoch 5-15:  ê¸‰ê²©í•œ ìƒìŠ¹ (+40-60%p) ğŸŸ¢
Epoch 15-20: ì•ˆì •ì  ìˆ˜ë ´ (75-96%)
```
â†’ "ëŠë¦¬ì§€ë§Œ í™•ì‹¤í•œ" ì „ëµ

### 4. ê³„ì‚° ë¹„ìš©

**ì§‘ê³„ ì‹œê°„** (Epoch 10 ê¸°ì¤€):
| ë°©ì–´ ê¸°ë²• | ì´ ì§‘ê³„ ì‹œê°„ | ë¼ìš´ë“œë‹¹ í‰ê·  |
|-----------|--------------|---------------|
| FedAVG | 0.542ì´ˆ | 0.054ì´ˆ |
| Krum | 12.901ì´ˆ | 1.290ì´ˆ |
| FLTG | 13.116ì´ˆ | 1.312ì´ˆ |
| Trimmed-Mean | 14.645ì´ˆ | 1.465ì´ˆ |

---

## ğŸ’¡ í•µì‹¬ í†µì°°

### 1. FLTGì˜ ì§„ì •í•œ ê°€ì¹˜

**FLTGê°€ í•„ìˆ˜ì ì¸ ê²½ìš°**:
- âœ… Byzantine ë¹„ìœ¨ â‰¥ 50% (ì ˆë°˜ ì´ìƒì´ ì•…ì˜ì )
- âœ… ê·¹ë‹¨ì  ë°ì´í„° í¸í–¥ (í´ë¼ì´ì–¸íŠ¸ë§ˆë‹¤ ì™„ì „íˆ ë‹¤ë¥¸ ë°ì´í„°)
- âœ… ì „í†µì  ë°©ë²•ì´ ëª¨ë‘ ì‹¤íŒ¨í•˜ëŠ” ìµœì•…ì˜ ì‹œë‚˜ë¦¬ì˜¤

**FLTGê°€ ê³¼ë„í•œ ê²½ìš°**:
- âŒ Byzantine ë¹„ìœ¨ < 30% (Krum, Trimmed-Meanìœ¼ë¡œ ì¶©ë¶„)
- âŒ IID ë˜ëŠ” ì•½í•œ Non-IID ë°ì´í„°
- âŒ ì¼ë°˜ì ì¸ ì—°í•© í•™ìŠµ í™˜ê²½

### 2. ì‹¤ë¬´ ê¶Œì¥ì‚¬í•­

| Byzantine ë¹„ìœ¨ | ë°ì´í„° ë¶„í¬ | ì¶”ì²œ ë°©ë²• | ì´ìœ  |
|----------------|-------------|-----------|------|
| < 20% | IID | FedAVG | ë‹¨ìˆœí•˜ê³  íš¨ê³¼ì  |
| 20-30% | ì•½í•œ Non-IID | Krum / Trimmed-Mean | ê²€ì¦ëœ ë°©ì–´, ë¹ ë¥¸ ìˆ˜ë ´ |
| 30-40% | ì¤‘ê°„ Non-IID | Krum / FLTG | ìƒí™©ì— ë”°ë¼ ì„ íƒ |
| â‰¥ 50% | ê·¹ë‹¨ì  Non-IID | FLTG í•„ìˆ˜! | ìœ ì¼í•˜ê²Œ ì‘ë™í•˜ëŠ” ë°©ë²• |

### 3. ë…¼ë¬¸ ì£¼ì¥ ê²€ì¦ ê²°ê³¼

**ë…¼ë¬¸ì˜ í•µì‹¬ ì£¼ì¥**:
> "FLTGëŠ” 50% ì´ìƒì˜ ì•…ì˜ì  í´ë¼ì´ì–¸íŠ¸ í™˜ê²½ì—ì„œë„ ê¸°ì¡´ ë°©ë²•ë³´ë‹¤ ìš°ìˆ˜í•œ ì„±ëŠ¥ì„ ë³´ì¸ë‹¤."

**ê²€ì¦ ê²°ê³¼**: âœ… **ë¶€ë¶„ì ìœ¼ë¡œ ì…ì¦ë¨!**

**ì„±ê³µì  ê²€ì¦** (50% Byzantine):
- âœ… Ultra Extreme Non-IID: FLTG 75.3% vs FedAVG 66.6% (+8.7%p)
- âœ… Class Imbalance: FLTG 96.0% vs ë‹¤ë¥¸ ë°©ë²•ë“¤ <11% (ì••ë„ì  ìš°ìœ„)
- âœ… Extreme ROP: FLTG 95.3% vs FedAVG 84.6% (+10.7%p)
- âœ… Extreme IPM: FLTG 96.2% vs FedAVG 88.7% (+7.5%p)

**ì´ˆê¸° ì‹¤í—˜ì˜ ë¬¸ì œì ** (20% Byzantine, IID):
- âŒ ë„ˆë¬´ ì‰¬ìš´ ì¡°ê±´: ëª¨ë“  ë°©ë²•ì´ 98%+ ë‹¬ì„±
- âŒ ë‚®ì€ Byzantine ë¹„ìœ¨: ì „í†µì  ë°©ë²•ë„ ì¶©ë¶„íˆ íš¨ê³¼ì 
- âŒ IID ë°ì´í„°: FLTGì˜ Non-IID ëŒ€ì‘ ëŠ¥ë ¥ì´ ë¶ˆí•„ìš”

### 4. "ë³µì¡ì„± vs íš¨ê³¼" íŠ¸ë ˆì´ë“œì˜¤í”„

**FLTGì˜ ê³„ì‚° ë¹„ìš©**:
- ì§‘ê³„ ì‹œê°„: ë‹¤ë¥¸ ë°©ë²•ì˜ ~20ë°°
- êµ¬í˜„ ë³µì¡ë„: ë†’ìŒ (5ë‹¨ê³„ ì•Œê³ ë¦¬ì¦˜)
- ë””ë²„ê¹… ë‚œì´ë„: ë†’ìŒ

**ì–¸ì œ ê°€ì¹˜ê°€ ìˆë‚˜?**:
- âœ… Byzantine ë¹„ìœ¨ì´ 50% ì´ìƒì¼ ë•Œ â†’ í•„ìˆ˜
- âœ… ë°ì´í„°ê°€ ê·¹ë‹¨ì ìœ¼ë¡œ ë¶ˆê· ë“±í•  ë•Œ â†’ ë§¤ìš° ìœ ìš©
- âŒ ì¼ë°˜ì  ìƒí™© â†’ ê³¼ë„í•œ ë³µì¡ì„±

---

## ğŸ”§ êµ¬í˜„ ê°œì„  ë°©í–¥

### ë‹¨ê¸° ê°œì„ 

1. **ì°¸ì¡° í´ë¼ì´ì–¸íŠ¸ ì„ íƒ ê°œì„ **
```python
# í˜„ì¬: ìµœì†Œê°’ ì„ íƒ
ref_idx = cos_sims_with_prev.index(min(cos_sims_with_prev))

# ê°œì„ ì•ˆ: ì¤‘ê°„ê°’ ì„ íƒ (ê·¹ë‹¨ê°’ íšŒí”¼)
sorted_indices = sorted(range(len(cos_sims_with_prev)),
                       key=lambda i: cos_sims_with_prev[i])
median_idx = sorted_indices[len(sorted_indices) // 2]
ref_idx = median_idx
```

2. **ì„œë²„ ê·¸ë˜ë””ì–¸íŠ¸ ê°€ì¤‘ì¹˜ ì¦ê°€**
```python
# ê°œì„ ì•ˆ: ì„œë²„ ê·¸ë˜ë””ì–¸íŠ¸ì— ë” ë†’ì€ ì‹ ë¢°
aggregated = 0.3 * g0 + 0.7 * sum(w * g for w, g in zip(weights, normalized_inputs))
```

3. **ë£¨íŠ¸ ë°ì´í„°ì…‹ í¬ê¸° ì¦ê°€**
```python
root_dataset_inds = np.random.choice(range(l), 500, replace=False)  # 100 â†’ 500
```

### ì¤‘ê¸° ê°œì„ 

1. **2ë‹¨ê³„ í•„í„°ë§**: ì„œë²„ ìœ ì‚¬ë„ + í´ë¼ì´ì–¸íŠ¸ ê°„ ìƒí˜¸ ìœ ì‚¬ë„
2. **ì ì‘ì  ê°€ì¤‘ì¹˜**: í•™ìŠµ ë‹¨ê³„ì— ë”°ë¼ ê°€ì¤‘ì¹˜ ì¡°ì •
3. **ì°¸ì¡°ì  ì•™ìƒë¸”**: ë‹¨ì¼ ì°¸ì¡°ì  ëŒ€ì‹  top-k ì°¸ì¡°ì  ì‚¬ìš©

### ì¥ê¸° ê°œì„ 

1. ë…¼ë¬¸ ì›ì €ìì™€ ì†Œí†µí•˜ì—¬ ì •í™•í•œ êµ¬í˜„ ì„¸ë¶€ì‚¬í•­ í™•ì¸
2. ë” ê°•í•œ ì‹¤í—˜ í™˜ê²½ (ë‹¤ì–‘í•œ ê³µê²©, ë³µì¡í•œ ë°ì´í„°ì…‹)
3. ì´ë¡ ì  ë¶„ì„ ë° ìˆ˜ë ´ì„± ì¦ëª…

---

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
FLTG-implementation/
â”œâ”€â”€ FL-Byzantine-Library/           # ê¸°ë°˜ í”„ë ˆì„ì›Œí¬
â”‚   â”œâ”€â”€ Aggregators/
â”‚   â”‚   â”œâ”€â”€ fltg.py                # âœ¨ FLTG êµ¬í˜„ (ì‹ ê·œ)
â”‚   â”‚   â”œâ”€â”€ fedavg.py
â”‚   â”‚   â”œâ”€â”€ krum.py
â”‚   â”‚   â”œâ”€â”€ trimmed_mean.py
â”‚   â”‚   â””â”€â”€ fl_trust.py
â”‚   â”œâ”€â”€ Attacks/
â”‚   â”‚   â”œâ”€â”€ rop.py
â”‚   â”‚   â”œâ”€â”€ ipm.py
â”‚   â”‚   â””â”€â”€ minmax.py
â”‚   â”œâ”€â”€ Models/
â”‚   â”‚   â””â”€â”€ CNN.py
â”‚   â”œâ”€â”€ main.py
â”‚   â”œâ”€â”€ mapper.py
â”‚   â””â”€â”€ parameters.py
â”œâ”€â”€ run_fig3_mnist.py              # Figure 3 ì¬í˜„ (MNIST)
â”œâ”€â”€ run_fig4_mnist.py              # Figure 4 ì¬í˜„ (MNIST)
â”œâ”€â”€ new_run_fig3_cifar.py          # Figure 3 ì¬í˜„ (CIFAR-10)
â”œâ”€â”€ run_extreme_experiments.sh     # ê·¹ë‹¨ì  Non-IID ì‹¤í—˜
â”œâ”€â”€ analyze_extreme_results.py     # ì‹¤í—˜ ê²°ê³¼ ë¶„ì„
â”œâ”€â”€ plot_fig3_mnist.py             # Figure 3 ì‹œê°í™”
â”œâ”€â”€ plot_fig4_mnist.py             # Figure 4 ì‹œê°í™”
â”œâ”€â”€ new_plot_fig3_cifar.py         # CIFAR-10 ì‹œê°í™”
â”œâ”€â”€ mnist_bias_utils.py            # MNIST bias ì„¤ì • ìœ í‹¸ë¦¬í‹°
â”œâ”€â”€ new_cifar_bias_utils.py        # CIFAR-10 bias ì„¤ì • ìœ í‹¸ë¦¬í‹°
â”œâ”€â”€ results_fig3_mnist/            # Figure 3 ì‹¤í—˜ ê²°ê³¼
â”œâ”€â”€ results_fig4_mnist/            # Figure 4 ì‹¤í—˜ ê²°ê³¼
â”œâ”€â”€ new_results_fig3_cifar/        # CIFAR-10 ì‹¤í—˜ ê²°ê³¼
â”œâ”€â”€ README.md                      # ë©”ì¸ ë¬¸ì„œ
â”œâ”€â”€ README_1.md                    # ë³¸ ë¬¸ì„œ
â”œâ”€â”€ ANALYSIS.txt                   # ìƒì„¸ ë¶„ì„
â””â”€â”€ EXTREME_RESULTS_SUMMARY.txt    # ê·¹ë‹¨ì  ì‹¤í—˜ ìš”ì•½
```

---

## ğŸš€ ì‹¤í—˜ ì‹¤í–‰ ë°©ë²•

### í™˜ê²½ ì„¤ì •

```bash
# ì˜ì¡´ì„± ì„¤ì¹˜
pip install torch torchvision matplotlib numpy scipy

# ë˜ëŠ” ê°€ìƒí™˜ê²½ ì‚¬ìš©
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate
pip install -r FL-Byzantine-Library/requirments.txt
```

### ê¸°ë³¸ ì‹¤í—˜ ì‹¤í–‰

```bash
cd FL-Byzantine-Library

# FLTG í…ŒìŠ¤íŠ¸
python main.py --dataset_name mnist --nn_name mnistnet \
  --num_client 20 --traitor 0.2 --attack rop \
  --aggr fltg --trials 1 --global_epoch 10 \
  --gpu_id -1 --bs 64
```

### ê·¹ë‹¨ì  Non-IID ì‹¤í—˜

```bash
cd FLTG-implementation

# ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰
nohup bash run_extreme_experiments.sh > extreme_output.log 2>&1 &

# ì§„í–‰ ìƒí™© í™•ì¸
tail -f extreme_output.log

# ê²°ê³¼ ë¶„ì„
python analyze_extreme_results.py
```

### Figure ì¬í˜„ ì‹¤í—˜

```bash
# Figure 3 (MNIST)
python run_fig3_mnist.py --epochs 20 --clients 100

# Figure 4 (MNIST)
python run_fig4_mnist.py --epochs 20 --clients 100

# Figure 3 (CIFAR-10)
python new_run_fig3_cifar.py --epochs 50 --clients 80 --gpu_id 0
```

### ê²°ê³¼ ì‹œê°í™”

```bash
# Figure 3 í”Œë¡¯
python plot_fig3_mnist.py --results_dir results_fig3_mnist/<timestamp>

# Figure 4 í”Œë¡¯
python plot_fig4_mnist.py --results_dir results_fig4_mnist/<timestamp>

# CIFAR-10 í”Œë¡¯
python new_plot_fig3_cifar.py --results_dir new_results_fig3_cifar/<timestamp>
```

---

## ğŸ“ˆ ì‹¤í—˜ ê²°ê³¼ í•´ì„

### ì„±ê³µ ê¸°ì¤€

**FLTGê°€ íš¨ê³¼ì ì¸ ê²½ìš°**:
- 50% Byzantine í™˜ê²½ì—ì„œ ë‹¤ë¥¸ ë°©ë²•ë³´ë‹¤ 5%p ì´ìƒ ë†’ì€ ì •í™•ë„
- ê·¹ë‹¨ì  Non-IID í™˜ê²½ì—ì„œ ì•ˆì •ì  ìˆ˜ë ´
- ë‹¤ë¥¸ ë°©ë²•ì´ ì‹¤íŒ¨í•  ë•Œ ìœ ì¼í•˜ê²Œ ì‘ë™

**ê°œì„ ì´ í•„ìš”í•œ ê²½ìš°**:
- 30% ì´í•˜ Byzantine í™˜ê²½ì—ì„œ ì „í†µì  ë°©ë²•ë³´ë‹¤ ë‚®ì€ ì„±ëŠ¥
- ì´ˆê¸° ìˆ˜ë ´ ì†ë„ê°€ ì§€ë‚˜ì¹˜ê²Œ ëŠë¦¼
- ê³„ì‚° ë¹„ìš© ëŒ€ë¹„ ì„±ëŠ¥ í–¥ìƒì´ ë¯¸ë¯¸í•¨

---

## ğŸ“ í•™ìˆ ì /ì‹¤ë¬´ì  ì‹œì‚¬ì 

### í•™ìˆ ì  ê´€ì 

1. **ì¬í˜„ì„±ì˜ ì¤‘ìš”ì„±**: ë…¼ë¬¸ ê²°ê³¼ ì¬í˜„ì„ ìœ„í•œ ì½”ë“œ ê³µê°œ í•„ìˆ˜
2. **ë¶€ì •ì  ê²°ê³¼ì˜ ê°€ì¹˜**: ì‹¤íŒ¨í•œ ì‹œë„ë„ ê³µìœ í•  í•„ìš”
3. **ì‹¤ì¦ì  ê²€ì¦**: ì´ë¡ ë§Œìœ¼ë¡œëŠ” ë¶€ì¡±, ë‹¤ì–‘í•œ í™˜ê²½ì—ì„œ ì‹¤í—˜ í•„ìš”
4. **ë²¤ì¹˜ë§ˆí¬ ì„¤ê³„**: ë„ˆë¬´ ì‰¬ìš´ ì¡°ê±´ì—ì„œëŠ” ì°¨ì´ê°€ ë“œëŸ¬ë‚˜ì§€ ì•ŠìŒ

### ì‹¤ë¬´ì  ê´€ì 

1. **ë‹¨ìˆœí•¨ì˜ ê°€ì¹˜**: Krum, Trimmed-Mean ê°™ì€ ê²€ì¦ëœ ë°©ë²• ìš°ì„  ê³ ë ¤
2. **í™˜ê²½ ë§ì¶¤**: ê³µê²© ë¹„ìœ¨, ë°ì´í„° íŠ¹ì„±ì— ë”°ë¼ ë°©ì–´ ê¸°ë²• ì„ íƒ
3. **ë¹„ìš© ëŒ€ë¹„ íš¨ê³¼**: ë³µì¡í•œ ì•Œê³ ë¦¬ì¦˜ì˜ ê³„ì‚° ë¹„ìš© ê³ ë ¤
4. **ì ì§„ì  ë„ì…**: ì¼ë°˜ í™˜ê²½ì—ì„œëŠ” ë‹¨ìˆœí•œ ë°©ë²•, ê·¹í•œ ìƒí™©ì—ì„œë§Œ FLTG

### ì—°êµ¬ ìœ¤ë¦¬

1. **íˆ¬ëª…ì„±**: ëª¨ë“  ì„¸ë¶€ì‚¬í•­ì„ ëª…ì‹œí•´ì•¼ í•¨
2. **ì¬í˜„ ê°€ëŠ¥ì„±**: ê³µì‹ êµ¬í˜„ ê³µê°œ í•„ìš”
3. **ì •ì§í•œ ë³´ê³ **: ì˜ˆìƒê³¼ ë‹¤ë¥¸ ê²°ê³¼ë„ ë³´ê³ 

---

## ğŸ† ìµœì¢… ê²°ë¡ 

### ë…¼ë¬¸ì˜ ì£¼ì¥ì€ ë§ì•˜ë‹¤!

**í•˜ì§€ë§Œ ì¡°ê±´ì´ ìˆë‹¤**:
1. Byzantine ë¹„ìœ¨ì´ 50% ì´ìƒì¼ ë•Œë§Œ ì§„ê°€ë¥¼ ë°œíœ˜
2. ê·¹ë‹¨ì  Non-IID í™˜ê²½ì—ì„œ íŠ¹íˆ ê°•ë ¥
3. ì¼ë°˜ì ì¸ í™˜ê²½ì—ì„œëŠ” ê³¼ë„í•œ ë³µì¡ì„±

### ì‹¤í—˜ì„ í†µí•´ ë°°ìš´ ê²ƒ

1. **ë²¤ì¹˜ë§ˆí¬ì˜ ì¤‘ìš”ì„±**: ë„ˆë¬´ ì‰¬ìš´ ì¡°ê±´ì—ì„œëŠ” ì°¨ì´ê°€ ì•ˆ ë³´ì„
2. **ê·¹í•œ ì¡°ê±´ í…ŒìŠ¤íŠ¸**: ì•Œê³ ë¦¬ì¦˜ì˜ ì§„ì •í•œ ê°•ì ì€ ê·¹í•œ ìƒí™©ì—ì„œ ë“œëŸ¬ë‚¨
3. **ì‹¤íŒ¨ë„ ì¸ì‚¬ì´íŠ¸**: ì´ˆê¸° ì‹¤íŒ¨ â†’ ë” ë‚˜ì€ ì‹¤í—˜ ì„¤ê³„ â†’ ë…¼ë¬¸ ê²€ì¦ ì„±ê³µ

### í”„ë¡œì íŠ¸ ì„±ê³¼

- âœ… FLTG ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ ì„±ê³µ
- âœ… ê·¹ë‹¨ì  ì¡°ê±´ì—ì„œ ë…¼ë¬¸ ì£¼ì¥ ê²€ì¦
- âœ… 50% Byzantine í™˜ê²½ì—ì„œ 100% ìŠ¹ë¥ 
- âœ… Class Imbalance ì‹œë‚˜ë¦¬ì˜¤ì—ì„œ ìœ ì¼í•˜ê²Œ ì‘ë™í•˜ëŠ” ë°©ë²• ì…ì¦
- âœ… ì‹¤ë¬´ ì ìš© ê°€ì´ë“œë¼ì¸ ì œì‹œ

### ì´ í”„ë¡œì íŠ¸ì˜ ê°€ì¹˜

> "ì‹¤íŒ¨í•œ ê²ƒì²˜ëŸ¼ ë³´ì˜€ì§€ë§Œ, ì˜¬ë°”ë¥¸ ì¡°ê±´ì—ì„œ í…ŒìŠ¤íŠ¸í•˜ì—¬ ë…¼ë¬¸ì˜ ì§„ì •í•œ ê°€ì¹˜ë¥¼ ì…ì¦í–ˆìŠµë‹ˆë‹¤."

- ì´ˆê¸° ê²°ê³¼ (97.1%): FLTGê°€ ì•½í•´ ë³´ì„
- ê·¹ë‹¨ì  ì‹¤í—˜ (96.0%): ë‹¤ë¥¸ ëª¨ë“  ë°©ë²•ì´ ì‹¤íŒ¨í–ˆì„ ë•Œ FLTGë§Œ ì‘ë™
- **ê²°ë¡ **: ë¬¸ì œëŠ” ì•Œê³ ë¦¬ì¦˜ì´ ì•„ë‹ˆë¼ ì‹¤í—˜ ì¡°ê±´ì´ì—ˆìŒ

---

## ğŸ“ ì¸ìš©

ì´ í”„ë¡œì íŠ¸ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ ì°¸ê³ í•˜ì‹ ë‹¤ë©´ ë‹¤ìŒì„ ì¸ìš©í•´ì£¼ì„¸ìš”:

```bibtex
@misc{fltg-implementation-2025,
  title={FLTG Byzantine-Robust Federated Learning Implementation and Validation},
  year={2025},
  note={Implementation and experimental validation of FLTG algorithm with comprehensive analysis}
}
```

---

## ğŸ“§ ë¬¸ì˜

ë¬¸ì œë‚˜ ì§ˆë¬¸ì´ ìˆìœ¼ì‹œë©´ Issueë¥¼ ì—´ì–´ì£¼ì„¸ìš”.

---

**Made with â¤ï¸ and ğŸ¤”**

*"ì‹¤íŒ¨ëŠ” ì„±ê³µì˜ ì–´ë¨¸ë‹ˆ" - ì˜ˆìƒê³¼ ë‹¤ë¥¸ ê²°ê³¼ë¥¼ í†µí•´ ë” ë§ì€ ê²ƒì„ ë°°ì› ìŠµë‹ˆë‹¤.*
